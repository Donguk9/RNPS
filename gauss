headers = {
  "x-generative-ai-client": YOUR_CLIENT_KEY,
  "x-openapi-token": YOUR_PASS_KEY,
  "x-generative-ai-user-email": YOUR_EMAIL
}

import requests as requests
models_api_endpoint_url = f"{ENDPOINT_URL}/openapi/chat/v1/models"


def model_read():
    response=requests.get(
        models_api_endpoint_url,
        headers=headers
    )
    print(response.json())

    
def nps_sum(text):    
    body = {
    "modelIds": [YOUR_MODEL_ID],
    "contents": ["""
                 The following data concerns Repair NPS (Net Promoter Score).
                 
                 This represents satisfaction scores for repair services conducted due to product issues.
                 
                 Summarize and organize the following data for easy understanding.
                 
                 - If the review is in Korean, all output must be in Korean.
                 - If the review is not in Korean, quote the review in its original language, and provide all other descriptions/analysis in English.
                 -------------------------------DATA-------------------------
                 """ + text],
    "llmConfig": {
        "max_new_tokens": 4096,
        "seed": None,
        "top_k": 14,
        "top_p": 0.94,
        "temperature": 0.01,
        "repetition_penalty": 1.04
    },
    "isStream": False,
    "systemPrompt":"""
    # Input
    - NPS (Net Promoter Score) Data
    
    # Output
    - A summary of the NPS data, including a very brief analysis.
    - Provide the output in narrative form using Markdown syntax.
    - Do not include any text other than the summary/analysis results.
    - If the NPS data is in Korean, output in Korean.
    - If the data is provided in a language other than Korean, output in English.
    """
    }

    api_endpoint_url = f"{ENDPOINT_URL}/openapi/chat/v1/messages"

    response=requests.post(
        api_endpoint_url,
        headers=headers,
        json=body
    )
    print(response)
    return response.json()["content"]


def sm_global(a):
    body = {
    "modelIds": [YOUR_MODEL_ID],
    "contents": ["""
                You will be provided with NPS information. This is the Repair satisfaction score measured by each subsidiary.
                Analyze this data and write an analysis report.
                
                - The analysis output must be in English.
                - Reviews themselves should be quoted in their original language.
                - However, if the review is in Korean, summarize it in Korean.
                - Do not include anything in the output except the analysis results.
                
                 -------------------------------DATA-------------------------
                 """ + a],
    "llmConfig": {
        "max_new_tokens": 4096,
        "seed": None,
        "top_k": 14,
        "top_p": 0.94,
        "temperature": 0.01,
        "repetition_penalty": 1.04
    },
    "isStream": False,
    "systemPrompt":"""
    # Input
    - NPS (Net Promoter Score) Data
    
    # Output
    - A summary of the NPS data, including a very brief analysis.
    - Provide the output in narrative form using Markdown syntax.
    - Do not include any text other than the summary/analysis results.
    - If the NPS data is in Korean, output in Korean.
    - If the data is provided in a language other than Korean, output in English.
    """
    }

    api_endpoint_url = f"{ENDPOINT_URL}/openapi/chat/v1/messages"

    response=requests.post(
        api_endpoint_url,
        headers=headers,
        json=body
    )
    print(response)
    return response.json()["content"]

    
def sm_local(a):
    body = {
    "modelIds": [YOUR_MODEL_ID],
    "contents": ["""
                 
Analyze the following NPS data and provide feedback.
- For the output language: Quote customer feedback in its original language. Write everything else (including categories and headers) in English.
- Exception: If the customer feedback is in Korean, write all items (including headers) in Korean.
- Writing in English/Korean includes the titles of the Markdown headers.
- Strictly adhere to these language conditions.
                 -------------------------------DATA-------------------------
                 """ + a],
    "llmConfig": {
        "max_new_tokens": 4096,
        "seed": None,
        "top_k": 14,
        "top_p": 0.94,
        "temperature": 0.01,
        "repetition_penalty": 1.04
    },
    "isStream": False,
    "systemPrompt":"""
# Role
- You are an expert in analyzing NPS (Net Promoter Score) and customer feedback.
- You will receive feedback scores and reviews from customers who have completed repairs for product issues.
- Statistical and analytical results will also be provided.
- These scores represent the service quality of a specific subsidiary.
- Based on the information, identify the reasons for the NPS decline and propose improvement plans.
- When writing improvements, follow the guidelines but provide specific and detailed feedback based on actual customer comments and context.
- Output only the feedback. No other introductory or concluding remarks.
- Language Policy: Quote feedback in original language; all other parts (categories/headers) in English.
- If the feedback is in Korean, all items must be in Korean.

# Output Requirements
- Provide only the feedback and analysis results.
- Format the output using Markdown.
- Use the following structure (Headers must follow the language policy):
{
## Analysis Results
## Declined Categories and Improvement Plans
## Conclusion
}
    """
    }

    api_endpoint_url = f"{ENDPOINT_URL}/openapi/chat/v1/messages"

    response=requests.post(
        api_endpoint_url,
        headers=headers,
        json=body
    )
    print(response)
    return response.json()["content"]    


# --- Commented sections also translated for consistency ---

# def Classification_Chat(a):
#     body = {
#     "modelIds": [YOUR_MODEL_ID],
#     "contents": ["""
#                 You will be provided with customer feedback data.
#                 I want to classify this feedback.
#                 The goal is to classify each piece of feedback into a 'Subcategory' within a 'Main Category'.
#                 Even if there isn't an exact match, choose the most similar Subcategory.
#                 Never omit any items. If 100 feedbacks are provided, all 100 must be classified.
#                 Note: Classify into 'Subcategories', not 'Main Categories'.
#                 If the feedback is in Korean, provide the category names in Korean.
#                 Ensure a result is always returned.
#
#                  -------------------------------DATA-------------------------
#                  """ + a],
#     "llmConfig": { ... },
#     "isStream": False,
#     "systemPrompt":"""
# # Output Format
# - Must follow the format below.
# - No text other than the classification table.
# - Do not use code blocks like ```markdown.
# - No omissions: All N feedbacks must be classified into a Subcategory.
# - Avoid clustering all items into a single category.
# - Add a 'Sample Feedback' column on the far right for each Subcategory.
# - If reviews are in Korean, translate Category names into Korean.
#
# Type | Category Name | Count | Sample Feedback |
# (Follow the table structure below...)
#
# Description: Rows starting with "1." are Main Categories and are not targets for individual classification. 
# The count for the Main Category is the sum of its Subcategories. 
# All feedback must be assigned to a Subcategory.
# """
#     }
